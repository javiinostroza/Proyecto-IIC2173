{"ast":null,"code":"var _jsxFileName = \"/home/javiera/Documents/UNIVERSIDAD/2020-2/Arquitectura de Software/G16/iic2173-proyecto-semestral-grupo-16v2-frontend/src/components/AdminCss/AdminCss.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { url_auth, url_requests, url_request_accept } from \"./../Routes\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport queryString from \"query-string\"; // import Rooms from '../Rooms/Rooms';\n// import './RoomsPanel.css'\n\nconst AdminCss = () => {\n  const history = useHistory();\n  const {\n    user,\n    isAuthenticated,\n    isLoading,\n    logout,\n    getAccessTokenSilently\n  } = useAuth0();\n  const [loaded, setLoaded] = useState(false);\n  const [isAdmin, setAdminStatus] = useState(false);\n  const [requests, setRequests] = useState([]);\n  useEffect(() => {\n    if (!loaded) {\n      setLoaded(true);\n      var requestOptions = {\n        method: 'GET'\n      };\n      const url_ = url_requests;\n      fetch(url_, requestOptions).then(response => {\n        return response.json().then(data => {\n          const list = data;\n          list.sort((a, b) => {\n            if (a.created_at > b.created_at) {\n              return 1;\n            } else {\n              return -1;\n            }\n          });\n          setRequests(list);\n          return data;\n        }).catch(err => {\n          console.log(err);\n        });\n      });\n    }\n  }, [requests]);\n\n  const checkUserUndefined = () => {\n    if (window.localStorage.getItem('userId') == undefined) {\n      window.localStorage.removeItem('userId');\n    }\n  };\n\n  const handleExitPanel = () => {\n    history.push('/admin');\n  };\n\n  const handleAccept = request => {\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    var urlencoded = new URLSearchParams();\n    urlencoded.append(\"id\", request.id);\n    let requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: urlencoded,\n      redirect: 'follow'\n    };\n    const url_ = url_request_accept;\n    fetch(url_, requestOptions).then(response => {\n      return response.json().then(data => {\n        console.log(data);\n        return data;\n      }).catch(err => {\n        console.log(err);\n      });\n    });\n    window.location.reload();\n  };\n\n  const handleLogOutClick = () => {\n    window.localStorage.removeItem('userId');\n    logout({\n      returnTo: url_auth\n    });\n  }; // If is admin: \n\n\n  if (window.localStorage.getItem('isAdmin') === \"true\") {\n    return isAuthenticated && /*#__PURE__*/React.createElement(\"div\", {\n      key: isLoading,\n      class: \"Full\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"Console\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: 'Bar',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      onClick: handleExitPanel,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 26\n      }\n    }, \"Exit to Admin Panel\")), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 21\n      }\n    }, \" \", /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      onClick: handleLogOutClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 26\n      }\n    }, \" Log Out\"))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"box\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 25\n      }\n    }, \"Requests\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"requests-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 25\n      }\n    }, requests.map(request => /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 56\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => handleAccept(request),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 33\n      }\n    }, \" \", request.id, \". Sala \", request.room_id, \" \", request.accepted ? 'Accepted' : 'Pending', \" \"), /*#__PURE__*/React.createElement(\"a\", {\n      href: request.url,\n      target: \"_blank\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 33\n      }\n    }, \"Review\"))))))));\n  } else {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 16\n      }\n    }, \" Unauthorized\");\n  }\n};\n\nexport default AdminCss;","map":{"version":3,"sources":["/home/javiera/Documents/UNIVERSIDAD/2020-2/Arquitectura de Software/G16/iic2173-proyecto-semestral-grupo-16v2-frontend/src/components/AdminCss/AdminCss.jsx"],"names":["React","useState","useEffect","useHistory","url_auth","url_requests","url_request_accept","useAuth0","queryString","AdminCss","history","user","isAuthenticated","isLoading","logout","getAccessTokenSilently","loaded","setLoaded","isAdmin","setAdminStatus","requests","setRequests","requestOptions","method","url_","fetch","then","response","json","data","list","sort","a","b","created_at","catch","err","console","log","checkUserUndefined","window","localStorage","getItem","undefined","removeItem","handleExitPanel","push","handleAccept","request","myHeaders","Headers","append","urlencoded","URLSearchParams","id","headers","body","redirect","location","reload","handleLogOutClick","returnTo","map","room_id","accepted","url"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {url_auth, url_requests, url_request_accept } from \"./../Routes\"\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport queryString from \"query-string\";\n// import Rooms from '../Rooms/Rooms';\n// import './RoomsPanel.css'\n\nconst AdminCss = () => {\n    const history = useHistory();\n    const { user, isAuthenticated, isLoading, logout, getAccessTokenSilently } = useAuth0();\n    const [loaded, setLoaded] = useState(false);\n    const [isAdmin, setAdminStatus] = useState(false);\n    const [requests, setRequests] = useState([])\n\n    useEffect(() => {\n        if (!loaded) {\n            setLoaded(true)\n            var requestOptions = {\n                method: 'GET',\n            };\n\n            const url_ = url_requests;\n            fetch(url_, requestOptions)\n                .then((response) => {\n                    return response.json().then((data) => {\n                        const list = data\n                        list.sort((a,b) => {\n                            if(a.created_at > b.created_at){\n                                return 1;\n                            }else{\n                                return -1;\n                            }\n                        })\n                        setRequests(list);\n                        return data;\n                    }).catch((err) => {\n                        console.log(err);\n                    })\n                })\n        }\n    }, [requests]);\n\n    const checkUserUndefined = () => {\n        if (window.localStorage.getItem('userId') == undefined) {\n            window.localStorage.removeItem('userId');\n        }\n    }\n\n    const handleExitPanel = () => {\n        history.push('/admin')\n    }\n\n    const handleAccept  = (request) => {\n        var myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n        var urlencoded = new URLSearchParams();\n        urlencoded.append(\"id\", request.id);\n\n        let requestOptions = {\n            method: 'POST',\n            headers: myHeaders,\n            body: urlencoded,\n            redirect: 'follow'\n        };\n\n\n        const url_ = url_request_accept;\n        fetch(url_, requestOptions)\n            .then((response) => {\n                return response.json().then((data) => {\n                    console.log(data)\n                    return data;\n                }).catch((err) => {\n                    console.log(err);\n                })\n            })\n        window.location.reload()\n    }\n\n\n\n    const handleLogOutClick = () => {\n        window.localStorage.removeItem('userId');\n        logout({ returnTo: url_auth })\n    }\n    // If is admin: \n    if (window.localStorage.getItem('isAdmin') === \"true\"){\n    return (\n        isAuthenticated && (\n        <div key={isLoading} class=\"Full\">\n            <div class=\"Console\">\n            <div className={'Bar'}>\n                    <div><button type=\"submit\" onClick={handleExitPanel}>Exit to Admin Panel</button></div>\n                    <h3> <button type=\"submit\" onClick={handleLogOutClick}> Log Out</button></h3>\n            </div>\n                <div class=\"container\">\n                    <div class=\"box\">\n                        <h3>Requests</h3>\n                        <div id=\"requests-list\">\n                            {requests.map((request) => <div>\n                                <button onClick={() => handleAccept(request)} > { request.id }. Sala {request.room_id} {request.accepted? 'Accepted': 'Pending'} </button>\n                                <a href={request.url} target = \"_blank\">Review</a>\n                            </div>)}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        )\n    )\n    } else {\n        return <div> Unauthorized</div>\n    }\n}\nexport default AdminCss;"]},"metadata":{},"sourceType":"module"}